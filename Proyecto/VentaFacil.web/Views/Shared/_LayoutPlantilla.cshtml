<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" href="~/Plantilla/images/favicon.svg" type="image/x-icon" />
    <title>@ViewData["Title"] - VentaFacil.web</title>

    <!-- ========== All CSS files linkup ========= -->
    <link rel="stylesheet" href="~/Plantilla/css/bootstrap.min.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/Plantilla/css/lineicons.css" asp-append-version="true" />
    <!-- Unused: materialdesignicons, fullcalendar removed -->
    <link rel="stylesheet" href="~/Plantilla/css/main.css" asp-append-version="true" />

    <!-- CSS personalizado -->
    <link rel="stylesheet" href="~/css/custom.css" asp-append-version="true" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
    <!-- Toastify-js -->
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
    <!-- SweetAlert2 (Para Confirmaciones) -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    @await RenderSectionAsync("Styles", required: false)
</head>
<body>
    <!-- ======== Preloader =========== -->
    <div id="preloader">
        <div class="spinner"></div>
    </div>
    <!-- ======== Preloader =========== -->

    <!-- Sidebar -->
    @if (User.Identity.IsAuthenticated)
    {
        @await Html.PartialAsync("_SideBar")
    }

    <div class="overlay"></div>

    <!-- ======== main-wrapper start =========== -->
    <main class="main-wrapper">
        <!-- Header -->
        @if (User.Identity.IsAuthenticated)
        {
            @await Html.PartialAsync("_TopBar")
        }

        <!-- ========== section start ========== -->
        <section class="section">
            <div class="container-fluid">
                <!-- Token ANTIFORGERY aquí -->
                @Html.AntiForgeryToken()
                
                <!-- Alertas Globales -->
                @await Html.PartialAsync("_Alert")

                @RenderBody()
            </div>
            <!-- end container -->
        </section>
        <!-- ========== section end ========== -->

        <!-- Footer -->
        @await Html.PartialAsync("_Footer")
    </main>
    <!-- ======== main-wrapper end =========== -->

    <!-- Container for modals outside main content for accessibility -->
    <div id="globalModalContainer"></div>
    @await RenderSectionAsync("Modals", required: false)

    <!-- ========= All Javascript files linkup ======== -->
    <script src="~/Plantilla/js/bootstrap.bundle.min.js" asp-append-version="true" defer></script>
    <script src="~/Plantilla/js/polyfill.js" asp-append-version="true" defer></script>
    <script src="~/Plantilla/js/main.js" asp-append-version="true" defer></script>
    <!-- Unused: Chart.js, dynamic-pie-chart, moment, fullcalendar, jvectormap, world-merc removed -->
    
    <!-- JQuery (Required for some existing views/scripts) -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Scripts de las vistas -->
    @await RenderSectionAsync("Scripts", required: false)

    <!-- Script de inicialización global y compatibilidad BS4 -> BS5 -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            console.log('=== VERIFICACIÓN DE CARGA ===');
            console.log('Bootstrap:', typeof bootstrap !== 'undefined');

            // Compatibilidad para data-dismiss (BS4) -> data-bs-dismiss (BS5)
            document.querySelectorAll('[data-dismiss="modal"]').forEach(function(el) {
                el.setAttribute('data-bs-dismiss', 'modal');
            });
            
            // Compatibilidad para data-toggle (BS4) -> data-bs-toggle (BS5)
            document.querySelectorAll('[data-toggle="tooltip"]').forEach(function(el) {
                el.setAttribute('data-bs-toggle', 'tooltip');
                new bootstrap.Tooltip(el);
            });
             document.querySelectorAll('[data-toggle="dropdown"]').forEach(function(el) {
                el.setAttribute('data-bs-toggle', 'dropdown');
                new bootstrap.Dropdown(el);
            });
            document.querySelectorAll('[data-toggle="collapse"]').forEach(function(el) {
                el.setAttribute('data-bs-toggle', 'collapse');
            });
        });
    </script>
</body>
</html>

